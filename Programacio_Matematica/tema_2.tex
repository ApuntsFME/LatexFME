\chapter{Dualitat}

\begin{teo}[feble de dualitat]\label{teo:dualitat-feble}
    Per tota solució factible $x$ d'un problema primal $\left(P\right)$ i tota solució factible $\lambda$ del dual $\left(D\right)$ associat
    \[ \lambda'b\leq c'x\,. \]
    \begin{proof}
    	Sigui $m\times n$ l'ordre de la matriu de restriccions $A$ al problema primal. Definim, per cada $i\in\{1,\ldots,m\}$ (per cada restricció de $(P)$) i per cada $j\in\{1,\ldots,n\}$ (per cada variable de $(P)$), respectivament, 
    	\begin{align*}
    		u_i &\defeq \lambda_i(a_i'x-b_i)\\
    		v_j &\defeq (c_j - \lambda'A_j)x_j\,.
    	\end{align*}
    	
    	Primerament, veiem que $u_i$ i $v_j$ sempre són positius. Si $a_i'x_i-b_i \ge 0$, llavors la $i$-èsima restricció de $(P)$ serà de la forma \[a_i'x \ge b_i\,,\] i per tant la corresponent variable dual $\lambda_i$ complirà $\lambda_i \ge 0$. D'altra banda, si $a_i'x_i-b_i \le 0$ la variable dual $\lambda_i$ serà negativa. Finalment, si $a_i'x_i-b_i = 0$, es té que $u_i = 0$ independentment de $\lambda_i$. Per tant $u_i \ge 0$ per tot $i$. Es pot fer un raonament similar per $v_j$.
    	
    	Ara, observem que
    	\begin{alignat}{2}{}
    		\sum_{i = 1}^{m} u_i &= \sum_{i = 1}^{m} \lambda_ia_i'x-\lambda_ib_i &= \lambda'Ax - \lambda'b \label{eq:ui}\\
    		\sum_{j = 1}^{n} v_i &= \sum_{j = 1}^{n} c_jx_j - \lambda'A_jx_j &= c'x - \lambda'Ax \label{eq:vj}
    	\end{alignat}
    	Si sumem \eqref{eq:ui} i \eqref{eq:vj} i tenim en compte que $u_i \ge 0$ i $v_j \ge 0$ per tot $i$ i $j$, obtenim
    	\begin{equation*}
    		\sum_{i = 1}^{m} u_i + \sum_{j = 1}^{n} v_i= c'x-\lambda'b \ge 0\,
    	\end{equation*}
    	i per tant \[c'x \ge \lambda'b\,.\]
    \end{proof}
\end{teo}
\begin{col}
	Per qualsevol problema primal $(P)$ i el seu dual $(D)$: 
    \begin{enumerate}[i)]
        \item $\left(P\right)$ il·limitat $\implies \left(D\right)$ infactible.
        \item $\left(D\right)$ il·limitat $\implies \left(P\right)$ infactible.
    \end{enumerate}
	\begin{proof}
		\begin{enumerate}[i)]
			\item[]
			\item Sigui $x$ solució factible de $(P)$ i $\lambda$ solució factible de $(D)$. Per hipòtesi $(P)$ és il·limitat i per tant \[\forall k \in \real\ \exists x\in P\qcolon c'x < k\,. \] Suposem que existís una solució dual $\lambda$ factible. Llavors, pel \hyperref[teo:dualitat-feble]{teorema feble de dualitat}, $\forall x\in P\colon \lambda'b \le c'x$. D'altra banda, per la proposició anterior, tenim que $\exists x\in P\colon \lambda'b > c'x\,$; contradicció. Per tant $(D)$ és infactible.
			%
			\item Sigui $\lambda$ solució factible de $(D)$ i $x$ solució factible de $(P)$. Per hipòtesi $(D)$ és il·limitat i per tant \[\forall k \in \real\ \exists x\in P\qcolon \lambda'b > k\,. \] Suposem que existís una solució primal $x$ factible. Llavors, pel \hyperref[teo:dualitat-feble]{teorema feble de dualitat}, $\forall \lambda\in D\colon \lambda'b \le c'x$. D'altra banda, per la proposició anterior, tenim que $\exists \lambda\in D\colon \lambda'b > c'x\,$; contradicció. Per tant $(P)$ és infactible.
		\end{enumerate}
	\end{proof}
\end{col}
\begin{teo}[fort de dualitat]
    Siguin $x^*, \lambda^*$ solucions òptimes de $\left(P\right)$ i el seu dual $\left(D\right)$, respectivament, llavors
    \[ \left(\lambda^*\right)^\prime b = c^\prime x^*.\]
\end{teo}
\begin{col}
    Si $\left(P\right)_e$ de rang complet amb solució, llavors $\left(D\right)$ té solució i òptim a $\lambda' = c_B'B^{-1}$.
\end{col}
\begin{teo}[de folga complementària]
    Siguin $x, \lambda$ solucions factibles de $\left(P\right)$ i $\left(D\right)$, respectivament. $x, \lambda$ són solucions òptimes si i només si
    \begin{center}
        \begin{tabular}{cl}
            $\lambda_j \left(a_j'x - b_j\right) = 0$, & $\forall j \in \left\{1, \dots, m\right\}$, \\
            $\left(c_i - \lambda'A_i\right) x_i = 0$, & $\forall i \in \left\{1, \dots, n\right\}$.
        \end{tabular}
    \end{center}
\end{teo}
\begin{defi}[Solució bàsica factible dual]
    Sigui $\left(P\right)_e$, una SBFD és tota SB de $\left(P\right)_e$ tal que $r \geq \left[0\right]$.
\end{defi}
\begin{alg}[del símplex dual]
    \begin{enumerate}
        \item[]
        \item {\bf Inicialització}: Trobem una SBFD ($\B, \N, x_B, z$).
        \item \label{simp_dual_pas2} {\bf Identificació de la SBF òptima i selecció VB sortint}:
            \begin{itemize}
                \item Si $x_B \geq \left[0\right]$, llavors és la SBF òptima. \textcolor{red}{\bf STOP!}
            \end{itemize}
            Altrament seleccionem VB $p$ amb $x_{B\left(p\right)} < 0$ (VB sortint).
        \item {\bf Càlcul de DBF de $\left(D\right)_e$}:
            \begin{itemize}
                \item $d_{r_N} = \left(\beta_p A_N\right)^\prime$ ($\beta_p$ és la fila $p$-èssima de $B^{-1}$).
                \item Si $d_{r_N} \geq \left[0\right]$, $\left(D\right)_e$ il·limitat. \textcolor{red}{\bf STOP!}
            \end{itemize}
        \item {\bf Càlcul de $\theta^*$ i selecció de la VNB entrant}:
            \begin{itemize}
                \item Càlcul de $\theta_D^*$: 
                    \[\theta_D^* = \min_{j \in \N \,|\, d_{r_{N_j}} < 0} \left\{-\frac{r_j}{d_{r_{N_j}}} \right\}.\]
                \item Variable no bàsica entrant: $q$ tal que $\theta^* = -\frac{x_q}{d_{r_{N_q}}}$.
            \end{itemize}
        \item {\bf Actualitzacions i canvi de base}:
            \begin{itemize}
                \item $r_N := r_N + \theta_D^* d_{r_N}$, \\
                    $\lambda := \lambda - \theta_D^* \beta_p^\prime$, \\
                    $r_{B\left(p\right)} := \theta_D^*$, \\
                    $z := z - \theta^* x_{B\left(p\right)}$.
                \item $\B := \B \setminus \left\{B\left(p\right)\right\} \cup \left\{q\right\}$, \\
                    $\N := \N \setminus \left\{q\right\} \cup \left\{B\left(p\right)\right\}$.
            \end{itemize}
        \item {\bf Anar} a \ref{simp_dual_pas2}.
    \end{enumerate}
\end{alg}
\begin{prop}
    Una SBFD òptima és degenerada ($\exists j \in \N$ tal que $r_j = 0$) si i només si $\left(P\right)_e$ té òptims alternatius.
\end{prop}
\begin{prop}
    Si $\left(P\right)_e$ no té cap SBFD degenerada, el símplex dual convergeix amb un nombre finit d'iteracions. Altrament, podem usar la regla de Bland (\ref{rgl:bland}) per a que convergeixi amb un nombre finit d'iteracions.
\end{prop}