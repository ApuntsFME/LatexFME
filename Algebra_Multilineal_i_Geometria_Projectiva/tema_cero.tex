\chapter{Formas Cuadráticas}

\section{Definición, matriz de una forma cuadrática y bases}

\begin{defi}[forma!bilineal simétrica]
    Sea $\E$ un $\k$-e.v. Diremos que una aplicación
    \[
        \begin{aligned}
            \phi \colon \E \times \E &\to \k \\
            (u,v) &\mapsto \phi(u,v)
        \end{aligned}
    \]
    es una forma bilineal simétrica si \begin{itemize}
        \item $\phi(u_1 + u_2, v) = \phi(u_1, v) + \phi(u_2, v)$
        \item $\phi(\lambda u, v) = \lambda\phi(u,v)$
        \item $\phi(u,v) = \phi(v,u)$
    \end{itemize}
    $\forall u,v,u_1,u_2 \in \E$ y $\forall \lambda \in \k$.
\end{defi}
\begin{defi}[forma!cuadrática]
    Sea $\phi$ una forma bilineal simétrica sobre un $\k$-e.v. $\E$.
    Diremos que la aplicación
    \[
        \begin{aligned}
            q \colon \E &\to \k \\
            u &\mapsto q(u) = \phi(u,u)
        \end{aligned}
    \]
    es la forma cuadrática asociada a $\phi$.
\end{defi}
\begin{obs}
    Se cumple que $q(\lambda u) = \lambda^2 q(u)$
\end{obs}
\begin{lema}
    Sea $\phi$ una forma bilineal simétrica sobre un $\k$-e.v. $\E$ con $\car \k \neq 2$
    y sea $q$ la forma cuadrática asociada a $\phi$, entonces
    \[
        \phi(u,v) = \frac{1}{2} ( q(u+v) - q(u) - q(v))
    \]
\end{lema}
\begin{proof}
    \[
    \begin{split}
        q(u+v) - q(u) - q(v) = \phi(u+v,u+v) - \phi(u,u) - \phi(v,v) = \\
        =\phi(u,u) + \phi(u,v) + \phi(v,u)  + \phi(v,v) - \phi(u,u) - \phi(v,v) =
        2 \phi(u,v)
    \end{split}
    \]
\end{proof}
\begin{defi}[matriz de una forma bilineal simétrica]
    Sea $\phi$ una forma bilineal simétrica/cuadrática sobre un $\k$-e.v. $\E$ y sea
    $B = \{u_1, \cdots, u_n \}$ una base. La matriz de $\phi$ en base $B$ es
    \[
        M_B(\phi) = (a_{ij}) = (\phi(u_i,u_j))
    \]
\end{defi}
\begin{obs}
    La matriz $M_B(\phi)$ es simétrica
\end{obs}
\begin{defi}[AQUI!HI HA DUES DEFIS]
    Sea $\E$ un $\k$-e.v. y sea $\phi \colon \E \times \E \to \k$ una
    forma bilineal simétrica.
    \begin{itemize}
        \item Diremos que $\phi$ es definida positiva si
        \[ \phi(x,x) > 0, \quad \forall x \in \E
        \quad x \neq \vec{0} \]
        \item Diremos que $\phi$ es definida negativa si
        \[ \phi(x,x) < 0, \quad \forall x \in \E
        \quad x \neq \vec{0} \]
        \item Diremos que $\phi$ es no definida en cualquier otro caso.
    \end{itemize}
\end{defi}
\begin{obs}
    Si $\phi$ es una forma bilineal simétrica y definida positiva
    entonces define un producto escalar sobre $\E$.
\end{obs}
\begin{defi*}
    Dada una matriz cuadrada $A$ (dim $n$) definimos
    \[
        A_k = (a_{ij}), \quad 1 \leq i, j \leq k \quad \text{y}
        \quad \delta_k(A) = \determinant{A_k}
    \]
\end{defi*}
\begin{teo}[de Sylvester]
    Sea $\E$ un $\k$-e.v. de dimension $n$ y sea
    $\phi \colon \E\times \E \to \k$ una forma bilineal simétrica,
    entonces
    \[
    \phi \text{ es definida positiva }\iff \delta_k(M_B(\phi)) > 0
    \quad\forall 1 \leq k \leq n \quad\forall B \text{ base de } \E
    \]
\end{teo}
\begin{proof}
    $\implies$

    Como $\phi$ es definida positiva, define un producto escalar
    sobre $\E$. Si tomamos una base $B$ cualquiera, mediante
    Gramm-Schmidt podemos construir una base ortogonal
    $B_2 = \{v_1, \cdots, v_n \}$. Por tanto
    \[
        i \neq j \implies \phi(v_i, v_j) = 0, \quad \phi(v_i,v_i)
        > 0 \quad 1 \leq i, j \leq n
    \]
    Llamamos $\phi(v_i, v_i) = \lambda_i > 0$. Por tanto
    \[
        M_{B_2}(\phi) = \begin{pmatrix}
        \lambda_1 & 0 & \cdots & 0 \\
        0 & \lambda_2 & \ddots & \vdots \\
        \vdots & \ddots & \ddots & 0 \\
        0 & \cdots & 0 & \lambda_n
        \end{pmatrix} \implies \determinant{M_{B_2}(\phi)} =
        \prod_{i=1}^{n} \lambda_i > 0
    \]
    Entonces, como $M_B(\phi) = S_{B,B_2}^TM_{B_2}(\phi)S_{B_2,B}$
    \[
        \determinant{M_B(\phi)} = \determinant{S_{B_2,B}}^2
        \determinant{M_{B_2}(\phi)} > 0
    \]
    Por lo tanto, la matriz de un producto escalar tiene
    determinante positivo independientemente de la base tomada.
    Observamos que $\phi$ también define un producto escalar en
    el subespacio vectorial $<v_1,\cdots,v_k>$ cuando lo
    restringimos a este. Por lo que hemos visto antes se tiene que
    \[
    \determinant{M_B(\phi)_k} = \delta_k(M_B(\phi)) > 0
    \quad \forall 1 \leq k \leq n.
    \]

    \noindent $\impliedby$

    \indent Tenemos que $\delta_k(M_B(\phi)) > 0 \quad \forall
    1 \leq k \leq n$. Aplicamos la siguiente variación de
    Gramm-Schmidt. Tomamos la base $B = \{ u_1, \cdots, u_n \}$
    Y hacemos la siguiente construcción:
    \[
        \begin{cases}
            v_1 = u_1 \\
            v_2 = \alpha_{2,1}u_1 + u2 \\
            v_3 = \alpha_{3,1}u_1 + \alpha_{3,2}u_2 + u_3 \\
            \vdots \\
            v_n = \alpha_{n,1}u_1 + \cdots + \alpha_{n,n-1}u_{n-1}
            + u_n
        \end{cases}
        \qquad \alpha_{i,j} \text{ son tales que } \phi(v_k, u_i)
        = 0 \quad \substack{2 \leq k \leq n \\ 1 \leq i \leq k-1}
    \]
    Propiedades de $\{ v_1, \cdots, v_n \}$
    \begin{itemize}
        \item $\forall k$, $\left< v_1, \cdots, v_k \right> =
        \left<u_1,\cdots,u_k\right>$
        En particular, $B_2 = \{v_1,\cdots, v_n\}$ es base de $\E$.
        \item $\phi(v_k, v_i) = 0$ $\forall 1 \leq i \leq k-1$
        porque $v_i \in \left< u_1, \cdots, u_i \right>$ y hemos tomado los
        $\alpha$ de manera que $\phi(v_k, u_i) = 0 \implies B_2$
        es base ortogonal
        \item La matriz $S_{B_2B}$
        \[
            S_{B_2B} = \begin{pmatrix}
                1 & \alpha_{2,1} & \cdots & \alpha_{n,1} \\
                0 & 1 & \ddots & \vdots \\
                \vdots & \ddots & \ddots & \alpha_{n,n-1} \\
                0 & \cdots & 0 & 1
            \end{pmatrix} \implies \determinant{S_{B_2B}} = 1
            \text{ y } \delta_k(S_{B_2B}) = 1
        \]
    \end{itemize}
    Finalmente, tenemos
    \[
        \begin{aligned}
            M_B(\phi) &= S_{B,B_2}^T M_{B_2}(\phi)S_{B,B_2} \\
            \left(\begin{array}{c c|c}
            k & \updownarrow &  \\
            \leftrightarrow &  &  \\
            \hline
             &  &
            \end{array}\right) &= \left(\begin{array}{c c|c}
            k & \updownarrow &  \\
            \leftrightarrow &  &  \\
            \hline
            &  &
            \end{array}\right) \left(\begin{array}{c c c| c c}
            \phi(v_1,v_1) & & & & \\
            & \ddots & & & \\
            & & \phi(v_k,v_k) & & \\
            \hline
            & & & \ddots & \\
            & & & & \phi(v_n,v_n)
            \end{array}\right) \left(\begin{array}{c c|c}
            k & \updownarrow &  \\
            \leftrightarrow &  &  \\
            \hline
            &  &
            \end{array}\right)
        \end{aligned}
    \]
    \[
        \implies \delta_k(M_B(\phi)) = \delta_k(S_{B,B_2}^t)
        \delta_k(M_{B_2}(\phi)) \delta_k(S_{B,B_2}) =
        \delta_k(M_{B_2}(\phi)) =
    \]
    \[
        = \prod_{i=1}^{k} \phi(v_i,v_i) > 0\text{ (por hipótesis)}
        \implies
        \frac{\delta_k(M_B(\phi))}{\delta_{k-1}(M_B(\phi))}
        = \phi(v_k,v_k) > 0
    \]
    Finalmente, $\forall x \in \E$
    \[
        \phi(x,x) =
        \phi\left(
            \sum_{i=1}^{k} x_iv_i,\sum_{i=1}^{k} x_iv_i
        \right) =
        \sum_{i=1}^{k} x_i^2 \phi(v_i,v_i) > 0 \text{ si } x \neq
        \vec{0}
    \]
\end{proof}

\begin{teo}[del método convergencia-pivote]
    Dada una forma bilineal simétrica $\phi$, queremos encontrar una base de
    $\E$, $B_2$, en la cual $M_{B_2}(\phi)$ sea una matriz diagonal. Partimos
    de una base $B$ i de $M_B(\phi)$. El procesos es: operación con filas a
    las dos matrices y luego la misma operacion pero en las columnas de la
    primera matriz únicamente (véase ejemplo).

    \begin{gather*}
        \left(M_B(\phi) \vert Id \right) \stackrel{\text{op. filas}}{\sim}
    \left( S_1M_B(\phi) \vert S_1 \right) \substack{\text{misma op.} \\
    \sim \\ \text{en columnas}} \left( S_1 M_B(\phi)S_1^T \vert S_1 \right)
    \sim \dots \sim \\ \sim \left( S_r \dots S_1 M_B(\phi)S_1^T \dots S_r^T
    \vert S_r \dots S_1 \right)
    \end{gather*}
    Donde la matriz de la izquierda es $M_{B_2}$ y es diagonal.


\end{teo}

\begin{example}
    \[
        q_\phi(x,y,z)=2x^2+2y^2-4xy-2yz; \quad A = M_B(\phi) =
        \begin{pmatrix}
            2 & -2 & 0 \\
            -2 & 2 & -1 \\
            0 & -1 & 0 \\
        \end{pmatrix}
    \]
    \begin{gather*}
        \left(
        \begin{array}{ccc|ccc}
            2 & -2 & 0 & 1 & 0 & 0 \\
            -2 & 2 & -1 & 0 & 1 & 0 \\
            0 & -1 & 0 & 0 & 0 & 1 \\
        \end{array}
        \right)
        \substack{\text{fila} \\ \sim \\ (1) + (2)}
        \left(
        \begin{array}{ccc|ccc}
            2 & -2 & 0 & 1 & 0 & 0 \\
            0 & 0 & -1 & 1 & 1 & 0 \\
            0 & -1 & 0 & 0 & 0 & 1 \\
        \end{array}
        \right)
        \substack{\text{columna} \\ \sim \\ (1) + (2)}
        \\
        \substack{\text{columna} \\ \sim \\ (1) + (2)}
        \left(
        \begin{array}{ccc|ccc}
            2 & 0 & 0 & 1 & 0 & 0 \\
            0 & 0 & -1 & 1 & 1 & 0 \\
            0 & -1 & 0 & 0 & 0 & 1 \\
        \end{array}
        \right)
        \substack{\text{fila} \\ \sim \\ (2) + (3)}
        \left(
        \begin{array}{ccc|ccc}
            2 & 0 & 0 & 1 & 0 & 0 \\
            0 & -1 & -1 & 1 & 1 & 1 \\
            0 & -1 & 0 & 0 & 0 & 1 \\
        \end{array}
        \right)
        \substack{\text{columna} \\ \sim \\ (2) + (3)}
        \\
        \substack{\text{columna} \\ \sim \\ (2) + (3)}
        \left(
        \begin{array}{ccc|ccc}
            2 & 0 & 0 & 1 & 0 & 0 \\
            0 & -2 & -1 & 1 & 1 & 1 \\
            0 & -1 & 0 & 0 & 0 & 1 \\
        \end{array}
        \right)
        \substack{\text{fila} \\ \sim \\ (3) - \frac{1}{2}(2)}
        \left(
        \begin{array}{ccc|ccc}
            2 & 0 & 0 & 1 & 0 & 0 \\
            0 & -2 & -1 & 1 & 1 & 1 \\
            0 & 0 & \frac{1}{2} & \frac{-1}{2} & \frac{-1}{2} & \frac{1}{2} \\
        \end{array}
        \right)
        \substack{\text{columna} \\ \sim \\ (3) - \frac{1}{2}(2)}
        \\
        \substack{\text{columna} \\ \sim \\ (3) - \frac{1}{2}(2)}
        \left(
        \begin{array}{ccc|ccc}
            2 & 0 & 0 & 1 & 0 & 0 \\
            0 & -2 & 0 & 1 & 1 & 1 \\
            0 & 0 & \frac{1}{2} & \frac{-1}{2} & \frac{-1}{2} & \frac{1}{2} \\
        \end{array}
        \right)
    \end{gather*}
    Entonces, en base $B$, los vectores de $B_2$ son:
    \begin{itemize}
        \item $v_1 = (1,0,0); \quad \phi (v_1, v_1) = 2$
        \item $v_2 = (1,1,1); \quad \phi (v_2, v_2) = -2$
        \item $v_3 = (\frac{-1}{2},\frac{-1}{2},\frac{1}{2}); \quad \phi (v_3,v_3) = \frac{1}{2}$
    \end{itemize}
    Y $\phi(v_i, v_j) = 0,$ $i \neq j$.
\end{example}


\begin{prop}
    Sea $\E$ un $\k$-e.v. de dimension $n$, sea $\phi \colon \E \times \E \to \k$
    una forma bilineal simétrica y sea $q$ su forma cuadrática asociada.
    Consideremos $B=\left\{ u_1, \dots u_n\right\}$ una base \ita{q-ortogonal} de $\E$.
    Sabemos que
    \[
        D=M_B \left( \phi \right)= \left(
        \begin{array}{ccc}
            \alpha _1 & \cdots & 0 \\
            \vdots & \ddots & \vdots \\
            0 & \cdots & \alpha _n
        \end{array} \right).
    \]
    Consideremos el subespacio vectorial $\E ^{\perp} \subseteq \E$ definido por
    $\E ^{\perp}= \left\{u \in \E \hspace{0,1cm} | \hspace{0,1cm} \phi \left( u, v \right)
    = 0 \hspace{0,15cm} \forall v \in \E \right\}$. Tenemos que
    \begin{enumerate}[i)]
        \item
            \[
                D=M_B \left( \phi \right)= \left(
                \begin{array}{cccccc}
                    \alpha _1 & 0 &  & \cdots &  & 0 \\
                    0 & \ddots &  &  &  &  \\
                     &  & \alpha _m &  &  & \\
                    \vdots &  &  & 0 &  & \vdots  \\
                     &  & \ &  & \ddots &  \\
                    0 &  &  & \cdots &  & 0
                \end{array} \right) \implies\ E ^{\perp} =
                \left< u_{m+1} , \dots , u_n \right> .
            \]
        \item
            \[
                \rg q + \dim \E^{\perp} = n \implies i_0 \left( q \right)
                 = \dim \E^{\perp}.
            \]
        \item Sean $\k=\real$,  e $i_+ \left( q \right)$ el número de elementos estrictamente positivos de
        la diagonal de $M_B \left( \phi \right)$. $i_+ \left( q \right)$ no depende de la base
        \emph{q-ortogonal} $B$ elegida.
        \item Sea $\k=\real$ y sean $\delta _0 = 1$, $\delta _1, \dots , \delta _n \neq 0$.
        Entonces, $i_- \left( q \right)$ es igual al número de cambios de signo en la
        secuencia $\delta _0, \dots , \delta _n$.
    \end{enumerate}
\end{prop}
\begin{proof}
    \begin{enumerate}[i)]
        \item[]
        \item \addtocounter{enumi}{1}
            $u_i  \in \left\{u_{m+1}, \dots , u_n \right\}$,
            \[
                \begin{aligned}
                    &\phi \left( u_j, u_i \right) = \left( 0 \ \cdots \ 1 \cdots \ 0 \ \right) \left(
                    \begin{array}{cccccc}
                        \alpha _1 &  &  &  &  &  \\
                         & \ddots &  &  &  &  \\
                         &  & \alpha _m &  &  & \\
                         &  &  & 0 &  &   \\
                         &  & \ &  & \ddots &  \\
                         &  &  &  &  & 0
                    \end{array} \right) \left(
                    \begin{array}{c}
                         0  \\
                         \vdots  \\
                         1  \\
                         \vdots \\
                         0
                    \end{array} \right) = 0 \hspace{0,3cm} \forall \hspace{0,12cm} 1 \leq j \leq n
                    \implies \\
                    &\implies \left< u_{m+1} , \dots , u_n \right> \subseteq \E^{\perp}.
                \end{aligned}
            \]
            Sea $u \in \E$ tal que $u \notin \left< u_{m+1}, \dots u_n \right> $. Se tiene que $\exists \hspace{0,2cm} 1 \leq i \leq m$ t.q. $x_i \neq 0$. Entonces,
            \[
                \begin{aligned}
                    e_i^t M_B\left( \phi \right) u = \left(0 \ \cdots \ 1 _i \ \cdots \ 0 \right) \left(
                    \begin{array}{cccccc}
                        \alpha _1 &  &  &  &  &  \\
                         & \ddots &  &  &  &  \\
                         &  & \alpha _m &  &  & \\
                         &  &  & 0 &  &   \\
                         &  & \ &  & \ddots &  \\
                         &  &  &  &  & 0
                    \end{array} \right) \left(
                    \begin{array}{c}
                         \vdots  \\
                         x_i  \\
                         \vdots \\
                    \end{array} \right) = \alpha _i x_i \neq 0 \implies u \notin \E^{\perp}.
                \end{aligned}
            \]
            Así pues, $\E ^{\perp} = \left< u_{m+1} , \dots , u_n \right> .$
        \item
            Sea $B'=\left\{u'_1, \dots , u'_n \right\}$ una base \ita{q-ortogonal} de $\E$.
            \[
                M_{B'}\left( \phi \right) = D' =  \left(
                \begin{array}{ccc}
                    \alpha ' _1 & \cdots & 0 \\
                    \vdots & \ddots & \vdots \\
                    0 & \cdots & \alpha ' _n
                \end{array} \right).
            \]
            Tenemos que
            \[
                m=i_+\left( q, B \right); \hspace{0,2cm} \F^+=\left<u_1, \dots u_m \right>;
                \hspace{0,2cm} \E=\F^+ \oplus \left<u_{m+1}, \dots u_n \right>=\F^+ \oplus \F^{ {\leq 0}}.
            \]
            Análogamente,
            \[
                m^\prime=i_+\left( q, B^\prime \right); \hspace{0,2cm} \F^{\prime +}=
                \left<u^\prime_1, \dots u^\prime_m \right>; \hspace{0,2cm} \E=\F^{\prime +}
                \oplus \left<u^{\prime}_{m+1}, \dots u^\prime_n \right>=\F^{\prime+}
                \oplus \F ^{\prime\leq 0}.
            \]
            Consideremos la función que proyecta un vector de $\F^+$ sobre $\F^{\prime+}$.
            \[
                \begin{aligned}
                    f \colon \F^+ &\to \E \to \F^{\prime+} \\
                    v &\longmapsto f(v).
                \end{aligned}
            \]
            Sea $v\in \F^+$ y sean $v_1$ y $v_2$ las proyecciones de $v$
            sobre $\F^{\prime+}$ y $\F^{\prime \leq 0}$ respectivamente.
            Tenemos que $f(v)=v_1$. Entonces,
            \[
                f(v)=0 \implies v_1=0 \implies v=v_2.
            \]
            Además, $0\leq \phi \left( v, v \right)$ y $\phi \left( v_2 , v_2 \right)=
             \phi \left( v, v \right) \leq 0$, de modo que $v=0$ y $f$ es inyectiva.
            Considerando la función que proyecta un vector de $\F^{\prime+}$ sobre $\F^{+}$.
            \[
                \begin{aligned}
                    g \colon \F^{\prime +} &\to \E \to \F^{+} \\
                    v &\longmapsto g(v).
                \end{aligned}
            \]
            y siguiendo un razonamiento análogo, obtenemos que $g$ es inyectiva,
            de modo que $m=m'$.
    \end{enumerate}



\end{proof}
\section{Clasificación afín y proyectiva}
\begin{defi}[forma!bilineal simétrica!afínmente equivalente]
    Sean $\E$ y $\F$ $\k$-espacios vectoriales. Sean
    \[
        \phi \colon \E \times \E \to \k,
    \]
    \[
        \psi \colon \F \times \F \to \k
    \]
formas bilineales simétricas. Diremos que $\phi$ y
$\psi$ son afínmente equivalentes, y escribiremos
$\phi \sim \psi$, si existe un isomorfismo $f \colon \E \to \F$ tal que
\[
    \phi \left(u, v \right) = \psi \left( f \left( u \right) ,
    f \left( v \right)  \right) \hspace{0,2cm} \forall u, v \in \E,
\]
\[
    \phi \left( f ^{-1} \left( u ' \right) ,  f ^{-1} \left( v ' \right)
    \right) = \psi \left( u' , v' \right) \hspace{0,2cm} \forall
    u', v' \in \F.
\]
\end{defi}
\begin{teo}[de Sylvester]
    \begin{enumerate}[i)]
        \item[]
        \item $\k=\real$
        \[
            \phi \sim \psi \iff \rg \phi = \rg \psi \text{ y }
            i_+\left( \phi \right) = i_+\left( \psi \right).
        \]
        \item $\k=\cx$
        \[
            \phi \sim \psi \iff \rg \phi = \rg \psi.
        \]
    \end{enumerate}

\end{teo}
