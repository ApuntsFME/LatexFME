\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[a4paper,margin=1in]{geometry}
\usepackage[pdftex]{hyperref}
\usepackage{amsmath,amsthm,amssymb,graphicx,mathtools,tikz,hyperref,enumerate}
\usepackage{mdframed,cleveref,cancel,stackengine,pgf,pgfplots,mathrsfs,thmtools}
\usepackage{xfrac,stmaryrd,commath,needspace,multirow}
\usepackage[shortlabels]{enumitem}
%\usepackage[spanish]{babel}

\newmdenv[leftline=false,topline=false]{topright}
\let\proof\relax
\usetikzlibrary{positioning,arrows, calc, babel}
\usetikzlibrary{external}
\tikzexternalize[prefix=figures/]
\pgfplotsset{compat=1.11}

\def\fbx#1{\vbox{\hbox{\hbox{#1}\setbox0\lastbox\copy0\kern\fboxsep\vrule width\fboxrule depth\dimexpr \fboxsep+\dp0\relax}%
            \hrule height\fboxrule}}

\newcommand{\bimplies}{\fbx{$\implies$}}
\newcommand{\bimpliedby}{\fbx{$\impliedby$}}

\newcommand{\n}{\mathbb{N}}
\newcommand{\z}{\mathbb{Z}}
\newcommand{\q}{\mathbb{Q}}
\newcommand{\cx}{\mathbb{C}}
\newcommand{\real}{\mathbb{R}}
\newcommand{\E}{\mathbb{E}}
\newcommand{\F}{\mathbb{F}}
\newcommand{\A}{\mathbb{A}}
\newcommand{\R}{\mathcal{R}}
\newcommand{\C}{\mathscr{C}}
\newcommand{\Pa}{\mathcal{P}}
\newcommand{\Es}{\mathcal{E}}
\newcommand{\V}{\mathcal{V}}
\newcommand{\T}{\mathcal{T}}
\newcommand{\bb}[1]{\mathbb{#1}}
\newcommand{\pdv}[3][]{\frac{\partial^{#1} #2}{\partial #3^{#1}}}
\newcommand{\dv}[3][]{\frac{\dif^{#1} #2}{\dif #3^{#1}}}
\let\k\relax
\newcommand{\k}{\Bbbk}
\newcommand{\ita}[1]{\textit{#1}}
\newcommand\inv[1]{#1^{-1}}
\newcommand\setb[1]{\left\{#1\right\}}
\newcommand{\vbrack}[1]{\langle #1\rangle}
\newcommand{\determinant}[1]{\begin{vmatrix}#1\end{vmatrix}}
\newcommand{\Po}{\mathbb{P}}
\newcommand{\lp}{\left(}
\newcommand{\rp}{\right)}
\DeclareMathOperator{\fr}{Fr}
\DeclareMathOperator{\Id}{Id}
\DeclareMathOperator{\ext}{Ext}
\DeclareMathOperator{\inte}{Int}
\DeclareMathOperator{\rie}{Rie}
\DeclareMathOperator{\rg}{rg}
\DeclareMathOperator{\gr}{gr}
\DeclareMathOperator{\nuc}{Nuc}
\DeclareMathOperator{\car}{car}
\DeclareMathOperator{\im}{Im}
\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\vol}{vol}
\DeclareMathOperator{\grad}{grad}
\DeclareMathOperator{\rot}{rot}
\DeclareMathOperator{\diver}{div}
\DeclareMathOperator{\sinc}{sinc}
\DeclareMathOperator{\graf}{graf}
\DeclareMathOperator{\tq}{\;t.q.\;}
\DeclareMathOperator{\disc}{disc}
\let\emptyset\varnothing
\renewcommand{\thesubsubsection}{\Alph{subsubsection}}
\setcounter{secnumdepth}{4}

\hypersetup{
    colorlinks,
    linkcolor=blue
}
\def\upint{\mathchoice%
    {\mkern13mu\overline{\vphantom{\intop}\mkern7mu}\mkern-20mu}%
    {\mkern7mu\overline{\vphantom{\intop}\mkern7mu}\mkern-14mu}%
    {\mkern7mu\overline{\vphantom{\intop}\mkern7mu}\mkern-14mu}%
    {\mkern7mu\overline{\vphantom{\intop}\mkern7mu}\mkern-14mu}%
  \int}
\def\lowint{\mkern3mu\underline{\vphantom{\intop}\mkern7mu}\mkern-10mu\int}

\newtheoremstyle{break}% name
{}%         Space above, empty = `usual value'
{}%         Space below
{}% Body font
{}%         Indent amount (empty = no indent, \parindent = para indent)
{\bfseries}% Thm head font
{}%        Punctuation after thm head
{\newline}% Space after thm head: \newline = linebreak
{#1 #2 \normalfont {\it #3}}%         Thm head spec

\newtheoremstyle{demo}% name
{}%         Space above, empty = `usual value'
{}%         Space below
{}% Body font
{}%         Indent amount (empty = no indent, \parindent = para indent)
{\it}% Thm head font
{}%        Punctuation after thm head
{\newline}% Space after thm head: \newline = linebreak
{#1. #2 \normalfont {\it #3}}%         Thm head spec

\newtheoremstyle{breakthm}% name
{}%         Space above, empty = `usual value'
{}%         Space below
{}% Body font
{}%         Indent amount (empty = no indent, \parindent = para indent)
{\bfseries}% Thm head font
{}%        Punctuation after thm head
{\newline}% Space after thm head: \newline = linebreak
{#1 \normalfont #3 (#2)\addcontentsline{toc}{subsection}{#1 #3}}%         Thm head spec

\newtheoremstyle{normal}% name
{}%         Space above, empty = `usual value'
{}%         Space below
{}% Body font
{}%         Indent amount (empty = no indent, \parindent = para indent)
{\bfseries}% Thm head font
{}%        Punctuation after thm head
{5pt plus 1pt minus 1pt}% Space after thm head: \newline = linebreak
{#1 #2 \normalfont #3}%         Thm head spec

\theoremstyle{normal}
\declaretheorem[style=normal,name=Lema,numberwithin=section]{lema}
\declaretheorem[style=breakthm,name=Lema,numberwithin=section]{teolema}
\declaretheorem[style=normal,name=Lema,numbered=no]{lema*}
\declaretheorem[style=normal,name=Observación,sibling=lema]{obs}
\declaretheorem[style=normal,name=Observación,numbered=no]{obs*}

\declaretheorem[style=break,name=Proposición,sibling=lema]{prop}
\declaretheorem[style=break,name=Proposición,numbered=no]{prop*}
\declaretheorem[style=break,name=Definición,sibling=lema]{defi}
\declaretheorem[style=break,name=Definición,numbered=no]{defi*}
\declaretheorem[style=break,name=Corolario,sibling=lema]{col}
\declaretheorem[style=break,name=Corolario,numbered=no]{col*}
\declaretheorem[style=break,name=Ejercicio,sibling=lema]{ej}
\declaretheorem[style=break,name=Ejercicio,numbered=no]{ej*}
\declaretheorem[style=break,name=Ejemplo,sibling=lema]{example}
\declaretheorem[style=break,name=Ejemplo,numbered=no]{example*}

\declaretheorem[style=demo,name=Demostración,qed=$\square$,numbered=no]{proof}

\let\thm\relax
\declaretheorem[style=breakthm,name=Teorema,sibling=lema]{teo}
\declaretheorem[style=break,name=Teorema,sibling=lema]{teo*}
